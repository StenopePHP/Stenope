<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Content processors | Stenope, the static website generation tool for Symfony</title>
        <meta name="description" content="Stenope Documentation. The static website generation tool for Symfony">
                    <link rel="stylesheet" href="/Stenope/build/style.c4e20cc1.css">
            </head>
    <body>
        <div class="main">
                            <div class="columns">
                    <aside class="sidebar">
                                                        <a href="/" class="logo">
                                Stenope
                            </a>
                            <nav class="navigation">
                                <a href="/" class="">
                                    About
                                </a>
                                                                                                    <a href="/build-configuration" class="">
                                        Configuring the build
                                    </a>
                                                                    <a href="/cli" class="">
                                        CLI
                                    </a>
                                                                    <a href="/link-contents" class="">
                                        Linking contents
                                    </a>
                                                                    <a href="/loading-content" class="">
                                        Loading content
                                    </a>
                                                                    <a href="/processors" class="active">
                                        Content processors
                                    </a>
                                                                    <a href="/supported-formats" class="">
                                        Supported formats
                                    </a>
                                                                    <a href="/supported-sources" class="">
                                        Supported sources
                                    </a>
                                                                    <a href="/syntax-highlighting" class="">
                                        Syntax highlighting
                                    </a>
                                                                    <a href="/twig" class="">
                                        Twig integration
                                    </a>
                                                                <a href="https://github.com/StenopePHP/Stenope">
                                    <span class="icon-github"></span>
                                    Github
                                </a>
                            </nav>
                        
                <div class="table-of-content">
            <p class="title">Table of content</p>
            <ol class="list">
                                    <li>
                        <a href="#what-are-processors">What are processors</a>
                                            </li>
                                    <li>
                        <a href="#writing-a-custom-processor">Writing a custom processor</a>
                                            </li>
                                    <li>
                        <a href="#ordering-processor">Ordering processor</a>
                                            </li>
                            </ol>
        </div>
                        </aside>
                    <main class="content">
                        <body><h1 id="content-processors">Content processors<a href="#content-processors" class="anchor"></a></h1>
<p>Content processor are the main entry point for custom behaviours in Stenope.</p>
<h2 id="what-are-processors">What are processors<a href="#what-are-processors" class="anchor"></a></h2>
<p>A processor acts on the raw content loaded from your sources as an array, before denormalization into its model.</p>
<p>Writing a custom processor allow you to apply virtually any modification to the decoded content before denormalization.</p>
<p>Internally, Stenope registers default processors for:</p>
<ul>
<li>Syntax highlighting for code blocks.</li>
<li>Adding <code class="code-inline" id="b80bb7740288fda1f201890375a60c8f">id</code> html attribute to titles and images.</li>
<li>Providing a <code class="code-inline" id="56d4ce3addd9e0185b21eb938ea5bc79">lastModified</code> property to contents based on their source last modification.</li>
<li>...</li>
</ul>
<h2 id="writing-a-custom-processor">Writing a custom processor<a href="#writing-a-custom-processor" class="anchor"></a></h2>
<p>To write your own processor, just implements the <code class="code-inline" id="9f55ee1fb6055d910ff7a3498baecb63">Stenope\Bundle\Behaviour\ProcessorInterface</code> interface:</p>
<pre class="code-multiline language-php"><code class="language-php" id="c659802fcb6b1c586955ccc3436bedc0"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Stenope<span class="token punctuation">\</span>Processor</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Model<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Stenope<span class="token punctuation">\</span>Bundle<span class="token punctuation">\</span>Behaviour<span class="token punctuation">\</span>ProcessorInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Stenope<span class="token punctuation">\</span>Bundle<span class="token punctuation">\</span>Content</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Load avatar from Gravatar for users
 */</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">GravatarProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">ProcessorInterface</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Apply modifications to decoded data before denormalization
     *
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token keyword">array</span></span>   <span class="token parameter">$data</span>    The decoded data
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token keyword">string</span></span>  <span class="token parameter">$type</span>    The model being processed (FQN)
     * <span class="token keyword">@param</span> <span class="token class-name">Content</span> <span class="token parameter">$content</span> The source content
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token keyword type-declaration">array</span> <span class="token operator">&amp;</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Content</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Only apply this processor on Users</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_a</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token operator">-&gt;</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token scope">User<span class="token punctuation">::</span></span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Ingore if url is already explicitly specified</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function"><span class="token punctuation">\</span>array_key_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'avatar'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Generate Gravatar url from email address</span>
        <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'avatar'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'https://www.gravatar.com/avatar/'</span> <span class="token operator">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></code></pre>
<p>That's it!</p>
<p><em>Note: See Stenope's <a href="https://github.com/StenopePHP/Stenope/tree/master/src/Processor" target="_blank">own processors</a> for more examples.</em></p>
<h2 id="ordering-processor">Ordering processor<a href="#ordering-processor" class="anchor"></a></h2>
<p>Processor are applied one after another, and a Processor <strong>A</strong> can modify the <code class="code-inline" id="7318a606a3118d468dae7078098fba7b">$data</code> that will then be used by a processor <strong>B</strong>.</p>
<p>To control processor execution order, use the <code class="code-inline" id="b988295c268025b49dfb3df26171ddc3">priority</code> tag property:</p>
<pre class="code-multiline language-yaml"><code class="language-yaml" id="cca01b99e7edd442696f3c2942b4bcc2"><span class="token key atrule">App\Stenope\Processor\TableOfContentProcessor</span><span class="token punctuation">:</span>
        <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> stenope.processor<span class="token punctuation">,</span> <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token number">-10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre>
<p><em>Note: High priority are executed first, lower priority (typically negative ones) are executed last.</em></p></body>                        <footer class="footer">
                                                            <p class="note">Stenope, the static website generation tool for Symfony.</p>
                                <a href="https://github.com/StenopePHP/Stenope">
                                    <span class="icon-github"></span>
                                    Stenope on Github
                                </a>
                                                    </footer>
                    </main>
                </div>
                    </div>
                    <script src="/Stenope/build/runtime.a2069aab.js" defer></script><script src="/Stenope/build/app.4c1a4699.js" defer></script>
            </body>
</html>
